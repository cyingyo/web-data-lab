<!doctype html>
<html lang="zh">

<head>
    <title>浏览电影</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <!-- VENDOR CSS -->
    <link rel="stylesheet" href="../vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../vendor/bootstrap-dialog/css/bootstrap-dialog.min.css">
    <link rel="stylesheet" href="../vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../vendor/linearicons/style.css">
    <link rel="stylesheet" href="../vendor/chartist/css/chartist-custom.css">
    <!-- MAIN CSS -->
    <link rel="stylesheet" href="../css/main.css">
    <!-- CUSTOM CSS -->
    <link rel="stylesheet" href="../css/common.css">
    <!-- ICONS -->
    <link rel="apple-touch-icon" sizes="76x76" href="../img/favicon.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../img/favicon.png">
</head>

<body class="layout-fullwidth">
<!-- WRAPPER -->
<div id="wrapper">
    <!-- NAVBAR -->
    <nav class="navbar navbar-default navbar-fixed-top nav-custom">
        <div class="brand">
            <a href="/index"><img src="../img/unimovies.png" width="150" alt="UniMovies Logo" class="img-responsive logo"></a>
        </div>
        <div class="container-fluid">
            <form class="navbar-form navbar-left">
                <div class="input-group">
                    <input v-model="key" type="text" value="" class="form-control" placeholder="电影名称 ...">
                    <span @click="toSearch" class="input-group-btn"><button type="button" class="btn btn-primary">搜索</button></span>
                </div>
            </form>
            <div id="navbar-menu">
                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><img src="../img/user.png" class="img-circle" alt="Avatar">
<!--                            <span>{{ username }}</span> -->
                            <span>用户</span>
                            <i class="icon-submenu lnr lnr-chevron-down"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="/order"><i class="lnr lnr-cog"></i> <span>我的订单</span></a></li>
                            <li><a href="/api/account/logout"><i class="lnr lnr-exit"></i> <span>退出</span></a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- END NAVBAR -->

    <!-- MAIN -->
    <div class="main">
        <!-- MAIN CONTENT -->
        <div class="main-content">
            <div class="container-fluid">

                <div class="panel-heading">
                    <h3 class="panel-title sale-title">UniMovies-统一电影聚合平台！</h3>
                </div>

                <div class="type-search">
                    <ul>
                        <li id="type-year"><strong>按年代：</strong>
                            <a v-for="year in years" @click="typeYear(year.value)">{{ year.label }}</a>
                        </li>
                        <li id="type-rate"><strong>按评分：</strong>
                            <a v-for="rate in rates" @click="typeRate(rate.value)">{{ rate.label }}</a>
                        </li>
                        <li id="type-zimu"><strong>按字母：</strong>
                            <a v-for="zimu in zimus" @click="typeZimu(zimu.value)">{{ zimu.label }}</a>
                        </li>
                    </ul>
                </div>

                <div class="row">
                    <!--电影列表-->
                    <div v-for="movie in movies" class="col-md-2 posi movie-item">
                        <div class="thumbnail img">
                            <a @click="toDetail(movie.id)" href="#">
                                <img :src="movie.cover">
                            </a>
                        </div>

                        <div class="content">
                            <a @click="toDetail(movie.id)" href="#" >《{{ movie.title }}》</a>
                            <div class="info">
                                <span v-if="movie.douban" class="douban">豆瓣</span>
                                <span v-if="movie.maoyan" class="maoyan">猫眼</span>
                            </div>
                        </div>
                    </div>
                    <!--电影列表End-->
                </div>

            </div>
        </div>
        <!-- END MAIN CONTENT -->
    </div>

    <!-- END MAIN -->
    <div class="clearfix"></div>
    <footer>
        <div class="container-fluid">

        </div>
    </footer>

</div>
<!-- END WRAPPER -->
</body>

<!-- Javascript -->
<script src="../vendor/jquery/jquery.min.js"></script>
<script src="../vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../vendor/bootstrap-dialog/js/bootstrap-dialog.min.js"></script>
<script src="../vendor/jquery-slimscroll/jquery.slimscroll.min.js"></script>
<script src="../vendor/jquery.easy-pie-chart/jquery.easypiechart.min.js"></script>
<script src="../vendor/chartist/js/chartist.min.js"></script>
<script src="../vendor/vue/vue.js"></script>
<script src="../vendor/vue/vue-resource.js"></script>
<script src="../js/common.js"></script>
<script src="../js/api.js"></script>

<script>

    let app = new Vue({
        el: '#wrapper',
        data: {
            movies: [],
            key: '',
            years: [
                {label: '全部', value: 0},
                {label: '2019', value: 2019},
                {label: '2018', value: 2018},
                {label: '2017', value: 2017},
                {label: '2016', value: 2016},
                {label: '2015', value: 2015},
                {label: '2014', value: 2014},
                {label: '2013', value: 2013},
                {label: '2012', value: 2012},
                {label: '2011', value: 2011},
                {label: '2010', value: 2010},
                {label: '2009', value: 2009},
                {label: '2008', value: 2008},
                {label: '2007', value: 2007},
                {label: '2006', value: 2006},
                {label: '2005', value: 2005},
                {label: '2004', value: 2004},
                {label: '2003', value: 2003},
                {label: '2002', value: 2002},
                {label: '2001', value: 2001},
                {label: '2000', value: 2000}
            ],
            rates: [
                {label: '9分以上', value: 9},
                {label: '8分以上', value: 8},
                {label: '7分以上', value: 7},
                {label: '6分以上', value: 6},
                {label: '5分以上', value: 5}
            ],
            zimus: []
        },
        methods: {
            toDetail(id) {
                window.location.href = '/movie/' + id;
            },
            toSearch() {
                window.location.href = '/search/' + this.key;
            },
            addToCart(id) {
                let vm = this;

                this.$http.post(api.cart.addNew + id)
                    .then(resp => {
                        let result = resp.body;
                        if (result.success) {
                            BootstrapDialog.alert("添加成功！")
                        } else {
                            console.log(resp);
                        }
                    })
            },
            fetchMovies(page) {
                let vm = this;

                this.$http.get(api.movie.listMovies + page)
                    .then(resp => {
                        let result = resp.body;

                        if (result.success) {
                            vm.movies = result.data;
                        } else {
                            console.log(resp);
                        }
                    })
            }
        },
        created() {

            this.fetchMovies(1);
        },
        mounted() {
            this.movies = [
                {
                    id: 1,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: false
                },
                {
                    id: 2,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: true
                },
                {
                    id: 3,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: false,
                    maoyan: false
                },
                {
                    id: 2,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: true
                },
                {
                    id: 2,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: true
                },
                {
                    id: 2,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: true
                },
                {
                    id: 2,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: true
                },
                {
                    id: 2,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: true
                },
                {
                    id: 2,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: true
                },
                {
                    id: 2,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: true
                },
                {
                    id: 2,
                    title: '西西里的美丽传说',
                    cover: '/img/xxl.jpg',
                    description: '当我还只是十三岁时，1941年春末的那一天，我初次见到了她那一天，墨索里尼向英法宣战，而我，得到了生命里的第一辆脚踏车',
                    douban: true,
                    maoyan: true
                }
            ];

            $(function() {
                function equal_cols(el) {
                    let h = 0;
                    $(el).each(function() {
                        $(this).css({'height':'auto'});
                        if($(this).outerHeight() > h) {
                            h = $(this).outerHeight();
                        }
                    });
                    $(el).each(function(){
                        $(this).css({'height':h});
                    });
                }

                equal_cols('.posi');
            });
        }
    })
</script>

</html>
